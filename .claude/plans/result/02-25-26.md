# Font Extraction from CSS: Size & Caching Impact

## What changed

Fonts were previously base64-inlined into `dist/styles.css` by Vite's lib mode build. A custom `extractCssFontsPlugin` now extracts all inlined fonts into separate asset files under `dist/assets/`.

## CSS bundle size reduction (`@harnessio/ui`)

| Metric                       | Before                    | After                     | Difference                          |
| ---------------------------- | ------------------------- | ------------------------- | ----------------------------------- |
| **`dist/styles.css` size**   | 3,236,619 bytes (3.09 MB) | 2,571,732 bytes (2.45 MB) | **−664,887 bytes (~20.5% smaller)** |
| **Inlined `data:font` URIs** | 3 (2 woff2 + 1 ttf)       | 0                         | **−3 inlined fonts**                |
| **Remaining inlined assets** | N/A                       | 4 images (2 png + 2 svg)  | Non-font assets left as data URIs   |
| **Separate font assets**     | 0                         | 3                         | See table below                     |

## Extracted font files (`dist/assets/`)

| Font file                      | Size                   | Source                                   |
| ------------------------------ | ---------------------- | ---------------------------------------- |
| `InterVariable.woff2`          | 352,240 bytes (344 kB) | `src/fonts/InterVariable.woff2`          |
| `JetBrainsMono-Variable.woff2` | 72,972 bytes (71 kB)   | `src/fonts/JetBrainsMono-Variable.woff2` |
| `font-0.ttf` (codicon)         | 73,464 bytes (72 kB)   | Monaco editor dependency (`codicon.ttf`) |

## Source fonts in `src/fonts/`

| File                                  | Size                   | Used in CSS                           |
| ------------------------------------- | ---------------------- | ------------------------------------- |
| `InterVariable.woff2`                 | 352,240 bytes (344 kB) | Yes — `@font-face` for Inter          |
| `InterVariable.ttf`                   | 862,936 bytes (843 kB) | No                                    |
| `JetBrainsMono-Variable.woff2`        | 72,972 bytes (71 kB)   | Yes — `@font-face` for JetBrains Mono |
| `JetBrainsMono-Regular.woff2`         | 92,164 bytes (90 kB)   | No                                    |
| `JetBrainsMono-VariableFont_wght.ttf` | 189,028 bytes (185 kB) | No                                    |

## Summary

- Base64 inlining inflated `styles.css` by ~665 kB (base64 adds ~33% overhead over binary).
- All 3 inlined fonts (2 woff2 + 1 ttf) are now extracted as separate files under `dist/assets/`, reducing the CSS bundle by ~20.5%.
- Only 4 small image data URIs (2 png + 2 svg) remain inlined in the CSS.
