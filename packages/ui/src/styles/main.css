/* Main app styles: design system, Tailwind, fonts, utilities, layout, Monaco, overrides */
@import url('@harnessio/core-design-system/core-styles');
@import url('@harnessio/core-design-system/themes');

@tailwind base;
@tailwind components;
@tailwind utilities;

@font-face {
  font-family: 'Inter';
  font-style: normal;
  font-weight: 100 900;
  font-display: swap;
  src: url('../fonts/InterVariable.woff2') format('woff2-variations');
}

@font-face {
  font-family: 'JetBrains Mono';
  font-style: normal;
  font-weight: 100 800;
  font-display: swap;
  src: url('../fonts/JetBrainsMono-Variable.woff2') format('woff2-variations');
}

@layer base {
  body {
    @apply bg-cn-0 text-cn-2 font-body-normal overscroll-y-none;
  }
}

@layer utilities {
  /*
    Handy CSS class to prevent Input background color becomes yellow in Chrome on autofill.
    Works as well with inputs with transparent background.

    https://stackoverflow.com/questions/2781549/removing-input-background-colour-for-chrome-autocomplete
  */
  .remove-autocomplete-styles:-webkit-autofill,
  .remove-autocomplete-styles:-webkit-autofill:hover,
  .remove-autocomplete-styles:-webkit-autofill:focus {
    transition:
      background-color 5000s,
      color 5000s;
  }

  .scrollbar-hidden {
    -ms-overflow-style: none;
    scrollbar-width: none;

    &::-webkit-scrollbar {
      display: none;
    }
  }

  @supports (field-sizing: content) {
    .field-sizing-content {
      field-sizing: content;
    }
  }
}

:root,
:host {
  --cn-breadcrumbs-height: 55px;
  --cn-tabs-nav-height: 45px;
  --cn-repo-header-height: 71px;
  --cn-page-nav-height: calc(var(--cn-tabs-nav-height) + var(--cn-breadcrumbs-height));
  --cn-page-nav-full-height: calc(
    var(--cn-tabs-nav-height) + var(--cn-breadcrumbs-height) + var(--cn-repo-header-height)
  );
}

.border-linear {
  @apply rounded-inherit pointer-events-none absolute inset-0 border border-transparent;
  mask:
    linear-gradient(#fff 0 0) padding-box,
    linear-gradient(#fff 0 0);
  mask-composite: exclude;
}

.connector-gradient {
  @apply bg-gradient-to-b from-[#2F2F33]/0 to-[#161619]/100;
}

.ci-gradient {
  @apply bg-gradient-to-r from-[#4f46e5] to-[#9333ea];
}

/* Text utilities */
.text-radial-gradient {
  /* remove hardcode colors */
  @apply text-cn-1/70 from-[#CA9AF4]/70 to-[#CA9AF4]/0 bg-clip-text;
}

/* Card utilities */
.card-auth {
  @apply w-[362px] border-none;
}

.card-auth-header {
  @apply space-x-0 space-y-0 p-0;
}

.card-auth-content {
  @apply py-cn-xl w-full;
}

/* Form utilities */
.text-form-error {
  @apply text-cn-danger text-cn-size-2 mt-cn-xs font-light;
}

.cn-graph-bg-size {
  background-size: 22px 22px;
}

.sub-menu-icon-bg {
  stop {
    stop-color: var(--cn-text-2);

    & + stop {
      stop-color: var(--cn-text-3);
    }
  }
}

mark {
  background: var(--cn-set-brand-primary-bg);
  color: var(--cn-set-brand-primary-text);
}

/* Hack for detecting scroll on select */
@keyframes detect-scroll {
  from,
  to {
    --can-scroll: ;
  }
}

[data-radix-select-viewport] {
  animation: detect-scroll linear;
  animation-timeline: scroll(self);

  --padding-if-can-scroll: var(--can-scroll) 4px 0 4px 4px;
  --padding-if-cant-scroll: 4px;
  padding: var(--padding-if-can-scroll, var(--padding-if-cant-scroll));
}

/* Select scrollbar */

[data-radix-select-viewport] {
  scrollbar-width: auto !important;
}

[data-radix-select-viewport]::-webkit-scrollbar {
  width: 14px;
  display: block !important;
}

[data-radix-select-viewport]::-webkit-scrollbar-thumb {
  background-color: var(--cn-comp-scrollbar-thumb);
  border: 4px solid transparent;
  border-radius: 7px;
  background-clip: content-box;
}

.layer-high {
  @apply z-[19];
}

.layer-medium {
  @apply z-[15];
}

.layer-low {
  @apply z-10;
}

/* Monaco editor */
.monaco-editor.monaco-editor {
  --vscode-editorGutter-background: transparent;
  --vscode-editor-background: transparent;
  --vscode-editorLineNumber-foreground: var(--cn-text-3);
  --vscode-editorLineNumber-activeForeground: var(--cn-text-1);
  outline-color: transparent !important;
}

.monaco-editor .overflow-guard {
  @apply border-0;
}

.monaco-diff-editor .monaco-editor .overflow-guard {
  @apply border-0;
}

.monaco-diff-editor .diffOverview .diffViewport {
  background: var(--cn-comp-scrollbar-thumb, lch(20.5% 2.62 285.74));

  &:hover {
    background: var(--cn-comp-scrollbar-thumb, lch(20.5% 2.62 285.74));
  }
}

.monaco-scrollable-element > .scrollbar > .slider {
  border-radius: var(--cn-rounded-full, 0.25rem);
  --vscode-scrollbarSlider-background: var(--cn-comp-scrollbar-thumb, lch(20.5% 2.62 285.74));
}

.monaco-diff-editor.side-by-side .editor.modified {
  @apply !border-cn-2 !shadow-cn-none !border-l !border-solid;
}

/* Layout */
.nested-sidebar-height {
  height: calc(100vh - var(--cn-breadcrumbs-height) - var(--cn-inset-layout-indent) - var(--cn-inset-border-width) * 2);
}

.repo-files-height {
  height: calc(
    100vh - var(--cn-page-nav-full-height) - var(--cn-inset-layout-indent) - var(--cn-inset-border-width) * 2
  );
}

.branch-selector-trigger-as-input {
  background-color: var(--cn-comp-input-bg);
  padding-inline: var(--cn-input-md-pl) var(--cn-input-md-pr);
}

.width-popover-max-width {
  max-width: var(--radix-popover-content-available-width);
}

.settings-form-width {
  width: 570px;
}

.file-explorer-header {
  /* has-[:hover]:bg-cn-selected rounded */
  &:has(:hover) {
    @apply bg-cn-hover rounded;
  }
}

@layer overrides {
  .cn-content-full-height {
    height: calc(var(--cn-sidebar-min-height) - var(--cn-header-height)) !important;
  }

  :root {
    --cn-inset-spacing: 6px;
  }

  @keyframes cn-slide-out-drawer {
    0% {
      transform: translate3d(0, 0, 0);
    }

    100% {
      transform: translate3d(calc((100% + var(--cn-inset-spacing)) * -1), 0, 0);
    }
  }

  .cn-sidebar-menu-drawer-content {
    top: calc(var(--cn-header-height) + var(--cn-inset-spacing)) !important;
    bottom: var(--cn-inset-spacing) !important;
    left: calc(var(--cn-sidebar-container-full-width) + var(--cn-inset-spacing)) !important;

    &[data-state='closed'] {
      animation-name: cn-slide-out-drawer !important;
    }

    &.cn-sidebar-menu-drawer-content-collapsed {
      left: calc(var(--cn-size-14) + var(--cn-inset-spacing)) !important;
    }
  }
}

/* Studio card */
@keyframes studio-card-border-spin {
  to {
    --border-angle: 1turn;
  }
}

@property --border-angle {
  syntax: '<angle>';
  inherits: true;
  initial-value: 0turn;
}
